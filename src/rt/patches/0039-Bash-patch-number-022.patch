From b72413687aa5e29a3b3501263c971a410e9d060d Mon Sep 17 00:00:00 2001
From: Thomas Braun <thomas.braun@byte-physics.de>
Date: Wed, 7 Jan 2015 18:12:57 +0100
Subject: [PATCH 39/40] Bash patch number 022

---
 msys/packages/bash/3.1/copy_cmd.c   | 2 +-
 msys/packages/bash/3.1/make_cmd.c   | 1 +
 msys/packages/bash/3.1/patchlevel.h | 2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/msys/packages/bash/3.1/copy_cmd.c b/msys/packages/bash/3.1/copy_cmd.c
index d36436c..2dbcbb8 100644
--- a/msys/packages/bash/3.1/copy_cmd.c
+++ b/msys/packages/bash/3.1/copy_cmd.c
@@ -116,7 +116,7 @@ copy_redirect (redirect)
     {
     case r_reading_until:
     case r_deblank_reading_until:
-      new_redirect->here_doc_eof = savestring (redirect->here_doc_eof);
+      new_redirect->here_doc_eof = redirect->here_doc_eof ? savestring (redirect->here_doc_eof) : 0;
       /*FALLTHROUGH*/
     case r_reading_string:
     case r_appending_to:
diff --git a/msys/packages/bash/3.1/make_cmd.c b/msys/packages/bash/3.1/make_cmd.c
index df20010..112262f 100644
--- a/msys/packages/bash/3.1/make_cmd.c
+++ b/msys/packages/bash/3.1/make_cmd.c
@@ -671,6 +671,7 @@ make_redirection (source, instruction, dest_and_filename)
   /* First do the common cases. */
   temp->redirector = source;
   temp->redirectee = dest_and_filename;
+  temp->here_doc_eof = 0;
   temp->instruction = instruction;
   temp->flags = 0;
   temp->next = (REDIRECT *)NULL;
diff --git a/msys/packages/bash/3.1/patchlevel.h b/msys/packages/bash/3.1/patchlevel.h
index cf96b44..56cf9b6 100644
--- a/msys/packages/bash/3.1/patchlevel.h
+++ b/msys/packages/bash/3.1/patchlevel.h
@@ -25,6 +25,6 @@
    regexp `^#define[ 	]*PATCHLEVEL', since that's what support/mkversion.sh
    looks for to find the patch level (for the sccs version string). */
 
-#define PATCHLEVEL 21
+#define PATCHLEVEL 22
 
 #endif /* _PATCHLEVEL_H_ */
-- 
2.1.0.msysgit.0.2.g8768113.dirty

